---
title: "Messenger Analysis"
format: html
---

```{python}
import pandas as pd
import json
import os
import datetime as dt
```

```{python}
data_directory = 'data/message_data'
data_file_names = os.listdir(data_directory)
data_files = [os.path.join(data_directory, data_file_name) 
             for data_file_name in data_file_names]
```

```{python}
messenger_data = pd.DataFrame()

for data_file in data_files:
    with open(data_file) as file:
        data = json.load(file)
    json_data = pd.json_normalize(data['messages'])
    messenger_data = pd.concat([messenger_data, json_data])
```

```{python}
messenger_data = messenger_data[[
    'sender_name',
    'timestamp_ms',
    'content'
]].sort_values(
    'timestamp_ms',
    ascending = False
    )

def convert_timestamp(timestamp_ms):
    timestamp = dt.datetime.fromtimestamp(timestamp_ms/1000)
    return timestamp

messenger_data['timestamp'] = messenger_data['timestamp_ms'].apply(convert_timestamp)
```