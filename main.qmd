---
title: "Messenger Analysis"
format: html
---

```{python}
import pandas as pd
import json
import os
import datetime as dt
```

```{python}
import functions.fbmessenger as fbm
```

```{python}
the_office = fbm.ms_import_data('data/the_office')

# subset and sort
the_office = the_office[[
    'sender_name',
    'timestamp_ms',
    'content'
]].sort_values(
    'timestamp_ms', 
    ascending = False
    )

# convert timestamp to datetime
the_office['timestamp'] = the_office['timestamp_ms'].apply(fbm.ms_convert_timestamp)
# drop timestamp column
the_office = the_office.drop('timestamp_ms', axis = 1)
# group messages by sender
the_office_grouped_messages = (the_office
                               .groupby('sender_name')
                               ['content']
                               .apply(lambda x: ' '.join(map(str, x)))
                               .reset_index()
                               )
# get grouped string length
the_office_grouped_messages['word_count'] = the_office_grouped_messages['content'].str.split().str.len()
# sort by word count
the_office_grouped_messages.sort_values('word_count', ascending = False)
```

